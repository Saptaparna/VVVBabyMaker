#ifndef puWeight_h
#define puWeight_h

//______________________________________________________________________________________
float puWeight(int nPUVtx, int variation=0){
  if(nPUVtx<0) return 0;
  if(variation==0){
    if(nPUVtx== 0) return 0.366077;
    if(nPUVtx== 1) return 0.893925;
    if(nPUVtx== 2) return 1.19772;
    if(nPUVtx== 3) return 0.9627;
    if(nPUVtx== 4) return 1.12098;
    if(nPUVtx== 5) return 1.16486;
    if(nPUVtx== 6) return 0.795599;
    if(nPUVtx== 7) return 0.495824;
    if(nPUVtx== 8) return 0.742182;
    if(nPUVtx== 9) return 0.878856;
    if(nPUVtx==10) return 0.964232;
    if(nPUVtx==11) return 1.0725;
    if(nPUVtx==12) return 1.12534;
    if(nPUVtx==13) return 1.17603;
    if(nPUVtx==14) return 1.20208;
    if(nPUVtx==15) return 1.20764;
    if(nPUVtx==16) return 1.20018;
    if(nPUVtx==17) return 1.18268;
    if(nPUVtx==18) return 1.144;
    if(nPUVtx==19) return 1.09663;
    if(nPUVtx==20) return 1.0656;
    if(nPUVtx==21) return 1.05117;
    if(nPUVtx==22) return 1.0516;
    if(nPUVtx==23) return 1.05063;
    if(nPUVtx==24) return 1.04986;
    if(nPUVtx==25) return 1.05817;
    if(nPUVtx==26) return 1.07216;
    if(nPUVtx==27) return 1.08303;
    if(nPUVtx==28) return 1.09569;
    if(nPUVtx==29) return 1.10787;
    if(nPUVtx==30) return 1.09462;
    if(nPUVtx==31) return 1.08262;
    if(nPUVtx==32) return 1.04125;
    if(nPUVtx==33) return 0.985752;
    if(nPUVtx==34) return 0.910807;
    if(nPUVtx==35) return 0.820923;
    if(nPUVtx==36) return 0.716787;
    if(nPUVtx==37) return 0.610013;
    if(nPUVtx==38) return 0.503118;
    if(nPUVtx==39) return 0.404841;
    if(nPUVtx==40) return 0.309195;
    if(nPUVtx==41) return 0.22792;
    if(nPUVtx==42) return 0.16369;
    if(nPUVtx==43) return 0.11318;
    if(nPUVtx==44) return 0.0773005;
    if(nPUVtx==45) return 0.0509221;
    if(nPUVtx==46) return 0.0318936;
    if(nPUVtx==47) return 0.0200936;
    if(nPUVtx==48) return 0.0122631;
    if(nPUVtx==49) return 0.00742646;
    if(nPUVtx==50) return 0.00438028;
    if(nPUVtx==51) return 0.00260777;
    if(nPUVtx==52) return 0.00156599;
    if(nPUVtx==53) return 0.000971358;
    if(nPUVtx==54) return 0.000729206;
    if(nPUVtx==55) return 0.000672709;
    if(nPUVtx==56) return 0.000730459;
    if(nPUVtx==57) return 0.000948791;
    if(nPUVtx==58) return 0.00135533;
    if(nPUVtx==59) return 0.00189419;
    if(nPUVtx==60) return 0.00308244;
    if(nPUVtx==61) return 0.00409665;
    if(nPUVtx==62) return 0.00487449;
    if(nPUVtx==63) return 0.00525606;
    if(nPUVtx==64) return 0.00578498;
    if(nPUVtx==65) return 0.00551468;
    if(nPUVtx==66) return 0.00500046;
    if(nPUVtx==67) return 0.00440983;
    if(nPUVtx==68) return 0.00401224;
    if(nPUVtx==69) return 0.00354754;
    if(nPUVtx==70) return 0.00310751;
    if(nPUVtx==71) return 0.00270211;
    if(nPUVtx==72) return 0.00233691;
    if(nPUVtx==73) return 0.00202529;
    if(nPUVtx>=74) return 0.00172328;
  }
  if(variation<0){//down
    if(nPUVtx== 0) return 0.379278;
    if(nPUVtx== 1) return 1.14117;
    if(nPUVtx== 2) return 1.25988;
    if(nPUVtx== 3) return 1.0989;
    if(nPUVtx== 4) return 1.25006;
    if(nPUVtx== 5) return 1.28085;
    if(nPUVtx== 6) return 0.920142;
    if(nPUVtx== 7) return 0.767693;
    if(nPUVtx== 8) return 1.09257;
    if(nPUVtx== 9) return 1.3374;
    if(nPUVtx==10) return 1.48624;
    if(nPUVtx==11) return 1.52827;
    if(nPUVtx==12) return 1.49779;
    if(nPUVtx==13) return 1.50093;
    if(nPUVtx==14) return 1.49728;
    if(nPUVtx==15) return 1.4437;
    if(nPUVtx==16) return 1.36783;
    if(nPUVtx==17) return 1.29894;
    if(nPUVtx==18) return 1.22733;
    if(nPUVtx==19) return 1.16569;
    if(nPUVtx==20) return 1.12543;
    if(nPUVtx==21) return 1.09059;
    if(nPUVtx==22) return 1.06406;
    if(nPUVtx==23) return 1.03996;
    if(nPUVtx==24) return 1.01924;
    if(nPUVtx==25) return 1.00604;
    if(nPUVtx==26) return 0.996975;
    if(nPUVtx==27) return 0.984886;
    if(nPUVtx==28) return 0.972847;
    if(nPUVtx==29) return 0.95656;
    if(nPUVtx==30) return 0.914677;
    if(nPUVtx==31) return 0.872239;
    if(nPUVtx==32) return 0.807112;
    if(nPUVtx==33) return 0.734267;
    if(nPUVtx==34) return 0.65103;
    if(nPUVtx==35) return 0.561399;
    if(nPUVtx==36) return 0.466396;
    if(nPUVtx==37) return 0.374559;
    if(nPUVtx==38) return 0.288558;
    if(nPUVtx==39) return 0.214518;
    if(nPUVtx==40) return 0.149749;
    if(nPUVtx==41) return 0.0998954;
    if(nPUVtx==42) return 0.0643477;
    if(nPUVtx==43) return 0.0395894;
    if(nPUVtx==44) return 0.0238912;
    if(nPUVtx==45) return 0.0138223;
    if(nPUVtx==46) return 0.00756684;
    if(nPUVtx==47) return 0.004156;
    if(nPUVtx==48) return 0.00221556;
    if(nPUVtx==49) return 0.00118683;
    if(nPUVtx==50) return 0.000642772;
    if(nPUVtx==51) return 0.000384094;
    if(nPUVtx==52) return 0.000272857;
    if(nPUVtx==53) return 0.000243368;
    if(nPUVtx==54) return 0.000289656;
    if(nPUVtx==55) return 0.000395793;
    if(nPUVtx==56) return 0.000543963;
    if(nPUVtx==57) return 0.00078281;
    if(nPUVtx==58) return 0.00115137;
    if(nPUVtx==59) return 0.00160404;
    if(nPUVtx==60) return 0.00256812;
    if(nPUVtx==61) return 0.0033401;
    if(nPUVtx==62) return 0.00387997;
    if(nPUVtx==63) return 0.00407904;
    if(nPUVtx==64) return 0.00437327;
    if(nPUVtx==65) return 0.00405792;
    if(nPUVtx==66) return 0.00357906;
    if(nPUVtx==67) return 0.00306806;
    if(nPUVtx==68) return 0.00271159;
    if(nPUVtx==69) return 0.0023274;
    if(nPUVtx==70) return 0.00197776;
    if(nPUVtx==71) return 0.00166723;
    if(nPUVtx==72) return 0.00139694;
    if(nPUVtx==73) return 0.00117213;
    if(nPUVtx>=74) return 0.000964963;
  }
  if(variation>0){
    if(nPUVtx== 0) return 0.356705;
    if(nPUVtx== 1) return 0.703874;
    if(nPUVtx== 2) return 1.1331;
    if(nPUVtx== 3) return 0.84596;
    if(nPUVtx== 4) return 1.01965;
    if(nPUVtx== 5) return 1.04908;
    if(nPUVtx== 6) return 0.72572;
    if(nPUVtx== 7) return 0.347758;
    if(nPUVtx== 8) return 0.500583;
    if(nPUVtx== 9) return 0.603052;
    if(nPUVtx==10) return 0.632203;
    if(nPUVtx==11) return 0.732849;
    if(nPUVtx==12) return 0.827779;
    if(nPUVtx==13) return 0.912507;
    if(nPUVtx==14) return 0.959919;
    if(nPUVtx==15) return 0.988481;
    if(nPUVtx==16) return 1.02442;
    if(nPUVtx==17) return 1.05282;
    if(nPUVtx==18) return 1.05104;
    if(nPUVtx==19) return 1.02729;
    if(nPUVtx==20) return 1.00559;
    if(nPUVtx==21) return 0.99799;
    if(nPUVtx==22) return 1.01493;
    if(nPUVtx==23) return 1.03752;
    if(nPUVtx==24) return 1.05812;
    if(nPUVtx==25) return 1.0855;
    if(nPUVtx==26) return 1.12067;
    if(nPUVtx==27) return 1.15508;
    if(nPUVtx==28) return 1.1925;
    if(nPUVtx==29) return 1.23145;
    if(nPUVtx==30) return 1.24627;
    if(nPUVtx==31) return 1.26784;
    if(nPUVtx==32) return 1.25902;
    if(nPUVtx==33) return 1.23373;
    if(nPUVtx==34) return 1.18149;
    if(nPUVtx==35) return 1.10478;
    if(nPUVtx==36) return 1.00239;
    if(nPUVtx==37) return 0.889404;
    if(nPUVtx==38) return 0.769071;
    if(nPUVtx==39) return 0.653862;
    if(nPUVtx==40) return 0.532499;
    if(nPUVtx==41) return 0.422593;
    if(nPUVtx==42) return 0.329801;
    if(nPUVtx==43) return 0.249936;
    if(nPUVtx==44) return 0.188554;
    if(nPUVtx==45) return 0.138154;
    if(nPUVtx==46) return 0.096836;
    if(nPUVtx==47) return 0.0686432;
    if(nPUVtx==48) return 0.0473417;
    if(nPUVtx==49) return 0.0324882;
    if(nPUVtx==50) return 0.021705;
    if(nPUVtx==51) return 0.0145288;
    if(nPUVtx==52) return 0.00958437;
    if(nPUVtx==53) return 0.00616762;
    if(nPUVtx==54) return 0.00427747;
    if(nPUVtx==55) return 0.00307056;
    if(nPUVtx==56) return 0.00224154;
    if(nPUVtx==57) return 0.00192254;
    if(nPUVtx==58) return 0.00202293;
    if(nPUVtx==59) return 0.00239738;
    if(nPUVtx==60) return 0.00365154;
    if(nPUVtx==61) return 0.00477849;
    if(nPUVtx==62) return 0.00572481;
    if(nPUVtx==63) return 0.0062735;
    if(nPUVtx==64) return 0.00704536;
    if(nPUVtx==65) return 0.00686592;
    if(nPUVtx==66) return 0.00637147;
    if(nPUVtx==67) return 0.00575494;
    if(nPUVtx==68) return 0.00536637;
    if(nPUVtx==69) return 0.00486586;
    if(nPUVtx==70) return 0.0043736;
    if(nPUVtx==71) return 0.0039046;
    if(nPUVtx==72) return 0.00346908;
    if(nPUVtx==73) return 0.00309034;
    if(nPUVtx==74) return 0.00270442;
  }
  return 1;//should not happen
}

#endif
